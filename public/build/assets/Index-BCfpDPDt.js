import{m as A,c as De,o as n,w as Oe,b as e,f as d,g as a,d as ke,x as Ae,y as Re,e as h,F as f,i as k,t as r,n as Ie,N as E}from"./app-DHKPQ0Ih.js";import{_ as Be}from"./LayoutMain-CsJ4vM3T.js";import"./LayoutAuthenticated-D6VXQ95G.js";import"./colors-B6DiSbTY.js";import"./main-CLApKTMv.js";import"./BaseDivider-DSUyGVju.js";const Pe={class:"p-6"},Fe={class:"overflow-x-auto"},Se={class:"min-w-full bg-white shadow-md rounded"},$e={key:0},Le={class:"py-2 px-4"},Me={class:"py-2 px-4"},je={class:"font-medium"},qe={class:"text-sm text-gray-500"},Ve={class:"text-sm text-gray-500"},Ke={class:"py-2 px-4"},Ue={key:0,class:"text-sm"},We={key:0,class:"font-medium"},ze={key:1,class:"text-gray-500"},Qe={key:2,class:"text-gray-500"},Je={key:1,class:"text-gray-400 italic text-sm"},Ye={class:"py-2 px-4"},Ge={class:"py-2 px-4"},He={key:0},Xe={class:"font-medium"},Ze={key:0,class:"text-xs text-gray-500 mt-1"},et={key:1,class:"text-gray-400 italic text-sm"},tt={class:"py-2 px-4"},st={class:"font-medium"},rt={key:0},ot={key:1,class:"text-gray-400 italic"},it={class:"text-xs text-gray-500"},nt={key:0},dt={class:"py-2 px-4"},lt={class:"py-2 px-4"},at={class:"flex space-x-2"},ct=["href"],ut=["onClick"],vt=["onClick"],xt=["onClick"],pt={class:"bg-gray-100 px-6 py-4 border-b flex justify-between items-center"},bt={class:"text-sm text-gray-600"},yt={class:"flex space-x-2"},_t=["href"],mt={class:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]"},gt={class:"pdf-preview bg-white border border-gray-200 shadow-sm"},ht={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},ft={class:"text-xs text-gray-700"},kt={key:0},wt={key:1},Ct={key:2},Tt={key:3},Et={key:4},Nt={class:"text-xs text-gray-700"},Dt={class:"font-medium"},Ot={key:0},At={class:"text-red-600 font-bold text-sm"},Rt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},It={class:"text-xs text-gray-700"},Bt={class:"text-xs text-gray-700"},Pt={class:"text-xs text-gray-700"},Ft={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},St={class:"text-xs text-gray-700"},$t={key:0,class:"overflow-x-auto mb-6"},Lt={class:"w-full border-collapse border border-gray-300 text-xs"},Mt={class:"border border-gray-300 p-2 text-center"},jt={class:"border border-gray-300 p-2 text-center"},qt={class:"border border-gray-300 p-2 text-center"},Vt={class:"border border-gray-300 p-2 text-center"},Kt={class:"border border-gray-300 p-2 text-center"},Ut={class:"bg-gray-100 font-bold"},Wt={class:"border border-gray-300 p-2 text-center"},zt={key:1,class:"mb-6"},Qt={key:0,class:"mb-6"},Jt={class:"list-disc list-inside space-y-1"},Yt={key:1,class:"mb-6"},Gt={class:"text-gray-800 font-medium text-sm mb-2"},Ht={key:0},Xt={class:"list-disc list-inside space-y-1 ml-2"},ns={__name:"Index",props:{contracts:Array,filters:Object},setup(w){var L;const N=A({search:((L=w.filters)==null?void 0:L.search)||""}),C=A(!1),o=A(null),R=()=>{E.visit(route("contracts.create"))},we=()=>{E.get(route("contracts.index"),{search:N.value.search})},Ce=i=>{o.value=i,C.value=!0},D=()=>{C.value=!1,o.value=null},Te=i=>{E.visit(route("contracts.edit",i))},Ee=i=>{confirm("Are you sure you want to delete this contract? This action cannot be undone.")&&E.delete(route("contracts.destroy",i))},I=i=>i?new Date(i).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",T=i=>!i||isNaN(i)?"0.00":parseFloat(i).toFixed(2),B=i=>!i||!i.contract_services?0:i.contract_services.reduce((t,l)=>{var c;if(((c=l.service)==null?void 0:c.type)!=="terms"){const u=parseInt(l.quantity)||0,b=parseFloat(l.unit_price)||0;return t+u*b}return t},0),O=i=>!i||!i.contract_services?0:i.contract_services.filter(t=>{var l;return((l=t.service)==null?void 0:l.type)==="service"&&t.quantity&&t.unit_price}).length,P=i=>!i||!i.contract_services?0:i.contract_services.filter(t=>{var l;return((l=t.service)==null?void 0:l.type)==="terms"}).length,F=i=>{if(!i||!i.contract_services)return[];const t=[];return i.contract_services.forEach(l=>{var c,u;((c=l.service)==null?void 0:c.type)==="service"&&((u=l.service)!=null&&u.specifications)&&t.push(...l.service.specifications)}),t.filter((l,c,u)=>c===u.findIndex(b=>b.description===l.description))},S=i=>!i||!i.contract_services?[]:i.contract_services.filter(t=>{var l;return((l=t.service)==null?void 0:l.type)==="terms"}),$=i=>!i||!i.contract_services?[]:i.contract_services.filter(t=>{var l;return((l=t.service)==null?void 0:l.type)==="service"}),Ne=i=>{i.key==="Escape"&&C.value&&D()};return typeof window<"u"&&window.addEventListener("keydown",Ne),(i,t)=>(n(),De(Be,null,{default:Oe(()=>{var l,c,u,b,M,j,q,V,K,U,W,z,Q,J,Y,G,H,X,Z,ee,te,se,re,oe,ie,ne,de,le,ae,ce,ue,ve,xe,pe,be,ye,_e,me,ge,he;return[e("div",Pe,[e("div",{class:"flex justify-between items-center mb-4"},[t[2]||(t[2]=e("h1",{class:"text-2xl font-bold"},"Contracts",-1)),e("button",{onClick:R,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition"}," Add New Contract ")]),e("form",{onSubmit:ke(we,["prevent"]),class:"mb-4"},[Ae(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>N.value.search=s),placeholder:"Search by client name or contract number",class:"border border-gray-300 rounded px-3 py-2 mr-2"},null,512),[[Re,N.value.search]]),t[3]||(t[3]=e("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded"}," Search ",-1))],32),e("div",Fe,[e("table",Se,[t[5]||(t[5]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left"},[e("th",{class:"py-2 px-4"},"Contract #"),e("th",{class:"py-2 px-4"},"Client"),e("th",{class:"py-2 px-4"},"Address"),e("th",{class:"py-2 px-4"},"Department"),e("th",{class:"py-2 px-4"},"Services"),e("th",{class:"py-2 px-4"},"Total Amount"),e("th",{class:"py-2 px-4"},"Date"),e("th",{class:"py-2 px-4"},"Actions")])],-1)),e("tbody",null,[!w.contracts||w.contracts.length===0?(n(),d("tr",$e,[e("td",{colspan:"8",class:"py-8 px-4 text-center text-gray-500"},[t[4]||(t[4]=h(" No contracts found. ")),e("button",{onClick:R,class:"text-green-600 hover:text-green-700 font-medium ml-1"}," Add your first contract ")])])):a("",!0),(n(!0),d(f,null,k(w.contracts,s=>{var v,x,p,y,_,m,g;return n(),d("tr",{key:s.id,class:"border-t hover:bg-gray-50"},[e("td",Le,r(s.contract_number),1),e("td",Me,[e("div",null,[e("div",je,r((v=s.client)==null?void 0:v.name),1),e("div",qe,r((x=s.client)==null?void 0:x.email),1),e("div",Ve,r((p=s.client)==null?void 0:p.phone),1)])]),e("td",Ke,[(y=s.client)!=null&&y.address?(n(),d("div",Ue,[s.client.address.street?(n(),d("div",We,r(s.client.address.street),1)):a("",!0),s.client.address.city||s.client.address.state?(n(),d("div",ze,r([s.client.address.city,s.client.address.state,s.client.address.zip_code].filter(Boolean).join(", ")),1)):a("",!0),s.client.address.country?(n(),d("div",Qe,r(s.client.address.country),1)):a("",!0)])):(n(),d("span",Je,"No address"))]),e("td",Ye,r(s.department),1),e("td",Ge,[s.contract_services&&s.contract_services.length>0?(n(),d("div",He,[e("div",Xe,r((_=s.contract_services[0].service)==null?void 0:_.service),1),e("span",{class:Ie([((m=s.contract_services[0].service)==null?void 0:m.type)==="service"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800","inline-block px-2 py-1 rounded text-xs font-medium mt-1"])},r(((g=s.contract_services[0].service)==null?void 0:g.type)==="service"?"Service":"Terms & Conditions"),3),s.contract_services.length>1?(n(),d("div",Ze," +"+r(s.contract_services.length-1)+" more service"+r(s.contract_services.length-1>1?"s":""),1)):a("",!0)])):(n(),d("span",et,"No services"))]),e("td",tt,[e("div",st,[O(s)>0?(n(),d("span",rt," $"+r(T(s.total_amount||B(s))),1)):(n(),d("span",ot,"No charges"))]),e("div",it,[h(r(O(s))+" paid service"+r(O(s)!==1?"s":"")+" ",1),P(s)>0?(n(),d("span",nt," + "+r(P(s))+" terms ",1)):a("",!0)])]),e("td",dt,r(I(s.date)),1),e("td",lt,[e("div",at,[e("a",{href:`/contracts/${s.id}/pdf`,target:"_blank",class:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition text-sm"}," Print PDF ",8,ct),e("button",{onClick:fe=>Ce(s),class:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition text-sm"}," Preview ",8,ut),e("button",{onClick:fe=>Te(s.id),class:"bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-700 transition text-sm"}," Edit ",8,vt),e("button",{onClick:fe=>Ee(s.id),class:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition text-sm"}," Delete ",8,xt)])])])}),128))])])])]),C.value?(n(),d("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:D},[e("div",{class:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:t[1]||(t[1]=ke(()=>{},["stop"]))},[e("div",pt,[e("div",null,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Contract Preview",-1)),e("p",bt,"Work Order #"+r((l=o.value)==null?void 0:l.contract_number),1)]),e("div",yt,[e("a",{href:`/contracts/${(c=o.value)==null?void 0:c.id}/pdf`,target:"_blank",class:"bg-red-600 text-white px-3 py-2 rounded hover:bg-red-700 transition text-sm"}," Download PDF ",8,_t),e("button",{onClick:D,class:"bg-gray-300 text-gray-700 px-3 py-2 rounded hover:bg-gray-400 transition text-sm"}," Close ")])]),e("div",mt,[e("div",gt,[t[24]||(t[24]=e("div",{class:"text-center border-b-2 border-red-600 pb-3 mb-5"},[e("h1",{class:"text-2xl font-bold text-red-600 mb-1"},"JOB WORK ORDER"),e("p",{class:"text-xs text-gray-600"},'"The Best Services in the Industry or Nothing at All"')],-1)),e("div",ht,[e("div",null,[t[7]||(t[7]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"WORK SITE:",-1)),e("div",ft,[(M=(b=(u=o.value)==null?void 0:u.client)==null?void 0:b.address)!=null&&M.name_account?(n(),d("div",kt,[e("strong",null,r(o.value.client.address.name_account),1)])):a("",!0),(V=(q=(j=o.value)==null?void 0:j.client)==null?void 0:q.address)!=null&&V.street?(n(),d("div",wt,r(o.value.client.address.street),1)):a("",!0),(W=(U=(K=o.value)==null?void 0:K.client)==null?void 0:U.address)!=null&&W.city||(J=(Q=(z=o.value)==null?void 0:z.client)==null?void 0:Q.address)!=null&&J.state?(n(),d("div",Ct,r([o.value.client.address.city,o.value.client.address.state,o.value.client.address.zip_code].filter(Boolean).join(", ")),1)):a("",!0),(H=(G=(Y=o.value)==null?void 0:Y.client)==null?void 0:G.address)!=null&&H.country?(n(),d("div",Tt,r(o.value.client.address.country),1)):a("",!0),(ee=(Z=(X=o.value)==null?void 0:X.client)==null?void 0:Z.address)!=null&&ee.full_address&&!((re=(se=(te=o.value)==null?void 0:te.client)==null?void 0:se.address)!=null&&re.street)?(n(),d("div",Et,r(o.value.client.address.full_address),1)):a("",!0)])]),e("div",null,[t[11]||(t[11]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"BILL TO:",-1)),e("div",Nt,[e("div",Dt,r((ie=(oe=o.value)==null?void 0:oe.client)==null?void 0:ie.name),1),e("div",null,[t[8]||(t[8]=e("strong",null,"Email:",-1)),h(" "+r((de=(ne=o.value)==null?void 0:ne.client)==null?void 0:de.email),1)]),e("div",null,[t[9]||(t[9]=e("strong",null,"Phone:",-1)),h(" "+r((ae=(le=o.value)==null?void 0:le.client)==null?void 0:ae.phone),1)]),(ue=(ce=o.value)==null?void 0:ce.client)!=null&&ue.area?(n(),d("div",Ot,[t[10]||(t[10]=e("strong",null,"Area:",-1)),h(" "+r((xe=(ve=o.value)==null?void 0:ve.client)==null?void 0:xe.area),1)])):a("",!0)])]),e("div",null,[t[12]||(t[12]=e("div",{class:"text-xs text-gray-700 mb-2"}," The following number must appear on all related correspondence, shipping papers, and invoices: ",-1)),t[13]||(t[13]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"WORK ORDER NUMBER:",-1)),e("span",At,r((pe=o.value)==null?void 0:pe.contract_number),1)])]),e("div",Rt,[e("div",null,[t[14]||(t[14]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"WORK DATE:",-1)),e("span",It,r(I((be=o.value)==null?void 0:be.date)),1)]),e("div",null,[t[15]||(t[15]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"REQUESTED BY:",-1)),e("span",Bt,r((_e=(ye=o.value)==null?void 0:ye.client)==null?void 0:_e.name),1)]),e("div",null,[t[16]||(t[16]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"DEPARTMENT:",-1)),e("span",Pt,r((me=o.value)==null?void 0:me.department),1)])]),e("div",Ft,[e("div",null,[t[17]||(t[17]=e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"INVOICE # FOR BILL:",-1)),e("span",St,r((ge=o.value)==null?void 0:ge.contract_number),1)]),t[18]||(t[18]=e("div",null,[e("span",{class:"text-red-600 font-bold text-sm block mb-1"},"TERMS:"),e("span",{class:"text-xs text-gray-700"},"15")],-1))]),$(o.value).length>0?(n(),d("div",$t,[e("table",Lt,[t[21]||(t[21]=e("thead",null,[e("tr",{class:"bg-red-600 text-white"},[e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Location"),e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Type of Service"),e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Frequency"),e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Qty"),e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Rate"),e("th",{class:"border border-gray-300 p-2 text-center font-bold"},"Total")])],-1)),e("tbody",null,[(n(!0),d(f,null,k($(o.value),s=>{var v,x,p,y,_,m,g;return n(),d("tr",{key:s.id},[e("td",Mt,r([(p=(x=(v=o.value)==null?void 0:v.client)==null?void 0:x.address)==null?void 0:p.city,(m=(_=(y=o.value)==null?void 0:y.client)==null?void 0:_.address)==null?void 0:m.state].filter(Boolean).join(", ")),1),e("td",jt,r((g=s.service)==null?void 0:g.service),1),t[19]||(t[19]=e("td",{class:"border border-gray-300 p-2 text-center"},"Monthly",-1)),e("td",qt,r(s.quantity),1),e("td",Vt,"$"+r(T(s.unit_price)),1),e("td",Kt,"$"+r(T(s.quantity*s.unit_price)),1)])}),128)),e("tr",Ut,[t[20]||(t[20]=e("td",{colspan:"5",class:"border border-gray-300 p-2 text-right"},"TOTAL AMOUNT:",-1)),e("td",Wt,"$"+r(T(B(o.value))),1)])])])])):a("",!0),(he=o.value)!=null&&he.contract_services&&o.value.contract_services.length>0?(n(),d("div",zt,[F(o.value).length>0?(n(),d("div",Qt,[t[22]||(t[22]=e("div",{class:"text-red-600 font-bold text-sm mb-4 border-b border-red-200 pb-2"},"SERVICE SPECIFICATIONS:",-1)),e("ul",Jt,[(n(!0),d(f,null,k(F(o.value),s=>(n(),d("li",{key:s.id,class:"text-xs text-gray-700"},r(s.description),1))),128))])])):a("",!0),S(o.value).length>0?(n(),d("div",Yt,[t[23]||(t[23]=e("div",{class:"text-red-600 font-bold text-sm mb-4 border-b border-red-200 pb-2"},"TERMS & CONDITIONS:",-1)),(n(!0),d(f,null,k(S(o.value),s=>{var v,x;return n(),d("div",{key:s.id,class:"mb-4"},[e("div",Gt,r((v=s.service)==null?void 0:v.service)+":",1),(x=s.service)!=null&&x.specifications&&s.service.specifications.length>0?(n(),d("div",Ht,[e("ul",Xt,[(n(!0),d(f,null,k(s.service.specifications,p=>(n(),d("li",{key:p.id,class:"text-xs text-gray-700"},r(p.description),1))),128))])])):a("",!0)])}),128))])):a("",!0)])):a("",!0)])])])])):a("",!0)]}),_:1}))}};export{ns as default};

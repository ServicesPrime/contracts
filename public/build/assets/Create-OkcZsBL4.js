import{h as S,T as Q,c as G,o as l,w as b,b as e,t as i,d as J,a as m,u as n,f as d,g as p,x as M,F as x,i as k,z as j,e as h,n as U,N as K}from"./app-DHKPQ0Ih.js";import{_ as R}from"./LayoutMain-CsJ4vM3T.js";import{_ as y,a as w}from"./FormControl-CwO7eJmf.js";import"./LayoutAuthenticated-D6VXQ95G.js";import"./colors-B6DiSbTY.js";import"./main-CLApKTMv.js";import"./BaseDivider-DSUyGVju.js";const W={class:"min-h-screen bg-gray-50"},X={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Y={class:"mb-8"},Z={class:"text-3xl font-bold text-gray-900"},ee={class:"text-gray-600 mt-2"},te={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},se={class:"p-6"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},oe={class:"md:col-span-2"},ie={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},ne={class:"p-6"},le=["value"],ae={key:0,class:"mt-4 bg-gray-50 rounded-lg p-4 border border-gray-200"},de={class:"text-sm text-gray-600"},ce={key:0,class:"mt-2"},ue={class:"ml-2"},pe={key:0},me={key:1},ve={key:2},ge={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},_e={class:"bg-gradient-to-r from-[rgb(3,20,58)] to-blue-800 px-6 py-4"},be={class:"flex items-center justify-between"},ye={class:"flex items-center space-x-3"},fe={class:"text-xl font-semibold text-white"},he={class:"p-6"},xe={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg"},we={class:"text-sm text-red-600"},ke={key:1,class:"text-center py-8 text-gray-500"},Ce={class:"space-y-6"},Se=["onClick","disabled"],Ve={class:"mb-4"},qe={class:"text-lg font-semibold text-gray-800"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={class:"md:col-span-2"},Me=["onUpdate:modelValue","onChange"],je=["value"],Ue={class:"relative"},ze={key:0,class:"md:col-span-2"},Ne={class:"bg-blue-50 rounded-lg p-3 border border-blue-200"},Ie={class:"flex justify-between items-center"},Fe={class:"text-sm font-medium text-blue-700"},Te={class:"text-lg font-bold text-blue-900"},Ae={class:"text-xs text-blue-600 mt-1"},De={key:1,class:"md:col-span-2"},Ee={key:2,class:"md:col-span-2"},He={class:"bg-white rounded-lg p-3 border border-gray-300"},Pe={class:"text-sm text-gray-600"},Le={key:0,class:"mt-2"},Oe={class:"list-disc list-inside ml-2 mt-1"},Qe={key:2,class:"mt-6"},Ge={class:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 border border-green-200"},Je={class:"flex justify-between items-center"},Ke={class:"text-sm text-gray-600 mt-1"},Re={class:"text-2xl font-bold text-green-700"},We={class:"flex justify-end space-x-4 pt-6"},Xe=["disabled"],Ye={key:0,class:"flex items-center"},Ze={key:1},lt={__name:"Create",props:{contract:{type:Object,default:()=>({})},clients:{type:Array,default:()=>[]},services:{type:Array,default:()=>[]},contractNumber:{type:String,default:()=>[]}},setup(C){var V,q,$,B;const v=C,g=S(()=>{var o;return!!((o=v.contract)!=null&&o.id)}),z=()=>{var o;return g.value&&((o=v.contract)!=null&&o.contract_services)?v.contract.contract_services.map(t=>({service_id:t.service_id,quantity:t.quantity,unit_price:t.unit_price})):[{service_id:"",quantity:"",unit_price:""}]},r=Q({contract_number:g.value?(V=v.contract)==null?void 0:V.contract_number:v.contractNumber||"",client_id:((q=v.contract)==null?void 0:q.client_id)||"",department:(($=v.contract)==null?void 0:$.department)||"",date:g.value?(B=v.contract)==null?void 0:B.date:new Date().toISOString().split("T")[0],services:z()}),u=S(()=>v.clients.find(o=>o.id==r.client_id)),N=S(()=>r.services.some(o=>f(o.service_id)?o.service_id:o.service_id&&o.quantity&&o.unit_price)),f=o=>{const t=_(o);return t&&t.type==="terms"},I=()=>r.services.filter(o=>o.service_id&&!f(o.service_id)&&o.quantity&&o.unit_price).length,F=()=>{r.services.push({service_id:"",quantity:"",unit_price:""})},T=o=>{r.services.length>1&&r.services.splice(o,1)},_=o=>v.services.find(t=>t.id==o),A=o=>{const t=r.services[o];f(t.service_id)&&(t.quantity="",t.unit_price="")},D=(o,t)=>{let s=o.target.value.replace(/[^\d.]/g,"");const a=s.split(".");a.length>2&&(s=a[0]+"."+a[1]),a[1]&&a[1].length>2&&(s=a[0]+"."+a[1].substring(0,2)),r.services[t].unit_price=s},E=o=>{const t=parseInt(o.quantity)||0,s=parseFloat(o.unit_price)||0;return(t*s).toFixed(2)},H=o=>{},P=()=>r.services.reduce((o,t)=>{if(!f(t.service_id)){const s=parseInt(t.quantity)||0,a=parseFloat(t.unit_price)||0;return o+s*a}return o},0).toFixed(2),L=()=>{g.value?r.put(route("contracts.update",v.contract.id)):r.post(route("contracts.store"))},O=()=>{K.visit(route("contracts.index"))};return(o,t)=>(l(),G(R,null,{default:b(()=>[e("div",W,[e("div",X,[e("div",Y,[e("h1",Z,i(g.value?"Edit Contract":"Create New Contract"),1),e("p",ee,"Fill in the information below to "+i(g.value?"update":"create")+" a contract",1)]),e("form",{onSubmit:J(L,["prevent"]),class:"space-y-8"},[e("section",te,[t[5]||(t[5]=e("div",{class:"bg-gradient-to-r from-[rgb(3,20,58)] to-blue-800 px-6 py-4"},[e("div",{class:"flex items-center space-x-3"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("h2",{class:"text-xl font-semibold text-white"},"Contract Information")])],-1)),e("div",se,[e("div",re,[m(y,{label:"Contract Number",required:"",error:n(r).errors.contract_number},{default:b(()=>[m(w,{modelValue:n(r).contract_number,"onUpdate:modelValue":t[0]||(t[0]=s=>n(r).contract_number=s),placeholder:"Enter contract number",inputmode:"numeric",onInput:t[1]||(t[1]=s=>n(r).contract_number=s.target.value.replace(/\D/g,""))},null,8,["modelValue"])]),_:1},8,["error"]),m(y,{label:"Date",required:"",error:n(r).errors.date},{default:b(()=>[m(w,{modelValue:n(r).date,"onUpdate:modelValue":t[2]||(t[2]=s=>n(r).date=s),type:"date"},null,8,["modelValue"])]),_:1},8,["error"]),e("div",oe,[m(y,{label:"Department",required:"",error:n(r).errors.department},{default:b(()=>[m(w,{modelValue:n(r).department,"onUpdate:modelValue":t[3]||(t[3]=s=>n(r).department=s),placeholder:"Enter department (e.g., Food and Beverage)"},null,8,["modelValue"])]),_:1},8,["error"])])])])]),e("section",ie,[t[13]||(t[13]=e("div",{class:"bg-gradient-to-r from-[rgb(3,20,58)] to-blue-800 px-6 py-4"},[e("div",{class:"flex items-center space-x-3"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),e("h2",{class:"text-xl font-semibold text-white"},"Client Information")])],-1)),e("div",ne,[m(y,{label:"Select Client",required:"",error:n(r).errors.client_id},{default:b(()=>[M(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>n(r).client_id=s),class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[t[6]||(t[6]=e("option",{value:""},"Select a client...",-1)),(l(!0),d(x,null,k(C.clients,s=>(l(),d("option",{key:s.id,value:s.id},i(s.name)+" - "+i(s.email),9,le))),128))],512),[[j,n(r).client_id]])]),_:1},8,["error"]),u.value?(l(),d("div",ae,[t[12]||(t[12]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Selected Client:",-1)),e("div",de,[e("div",null,[t[7]||(t[7]=e("strong",null,"Name:",-1)),h(" "+i(u.value.name),1)]),e("div",null,[t[8]||(t[8]=e("strong",null,"Email:",-1)),h(" "+i(u.value.email),1)]),e("div",null,[t[9]||(t[9]=e("strong",null,"Phone:",-1)),h(" "+i(u.value.phone),1)]),e("div",null,[t[10]||(t[10]=e("strong",null,"Area:",-1)),h(" "+i(u.value.area),1)]),u.value.address?(l(),d("div",ce,[t[11]||(t[11]=e("strong",null,"Address:",-1)),e("div",ue,[u.value.address.street?(l(),d("div",pe,i(u.value.address.street),1)):p("",!0),u.value.address.city||u.value.address.state||u.value.address.zip_code?(l(),d("div",me,i([u.value.address.city,u.value.address.state,u.value.address.zip_code].filter(Boolean).join(", ")),1)):p("",!0),u.value.address.country?(l(),d("div",ve,i(u.value.address.country),1)):p("",!0)])])):p("",!0)])])):p("",!0)])]),e("section",ge,[e("div",_e,[e("div",be,[e("div",ye,[t[14]||(t[14]=e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),e("h2",fe,"Services ("+i(n(r).services.length)+")",1)]),e("button",{type:"button",onClick:F,class:"bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center space-x-2"},t[15]||(t[15]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),e("span",null,"Add Service",-1)]))])]),e("div",he,[n(r).errors.services?(l(),d("div",xe,[e("p",we,i(n(r).errors.services),1)])):p("",!0),n(r).services.length===0?(l(),d("div",ke,t[16]||(t[16]=[e("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),e("p",{class:"text-lg font-medium"},"No services added yet",-1),e("p",{class:"text-sm mt-1"},'Click "Add Service" to start adding services to this contract',-1)]))):p("",!0),e("div",Ce,[(l(!0),d(x,null,k(n(r).services,(s,a)=>(l(),d("div",{key:`service-${a}`,class:"bg-gray-50 rounded-lg p-4 border border-gray-200 relative"},[e("button",{type:"button",onClick:c=>T(a),class:U(["absolute top-2 right-2 text-gray-400 hover:text-red-500 transition-colors duration-200",{"opacity-50 cursor-not-allowed":n(r).services.length===1}]),disabled:n(r).services.length===1},t[17]||(t[17]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),10,Se),e("div",Ve,[e("h3",qe,"Service #"+i(a+1),1)]),e("div",$e,[e("div",Be,[m(y,{label:`Select Service ${a+1}`,required:"",error:n(r).errors[`services.${a}.service_id`]},{default:b(()=>[M(e("select",{"onUpdate:modelValue":c=>s.service_id=c,class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:c=>A(a)},[t[18]||(t[18]=e("option",{value:""},"Select a service...",-1)),(l(!0),d(x,null,k(C.services,c=>(l(),d("option",{key:c.id,value:c.id},i(c.service)+" ("+i(c.type==="service"?"Service":"Terms & Conditions")+") ",9,je))),128))],40,Me),[[j,s.service_id]])]),_:2},1032,["label","error"])]),f(s.service_id)?p("",!0):(l(),d(x,{key:0},[m(y,{label:`Quantity ${a+1}`,required:"",error:n(r).errors[`services.${a}.quantity`]},{default:b(()=>[m(w,{modelValue:s.quantity,"onUpdate:modelValue":c=>s.quantity=c,placeholder:"Enter quantity",inputmode:"numeric",onInput:c=>{s.quantity=c.target.value.replace(/\D/g,""),H(a)}},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1032,["label","error"]),m(y,{label:`Unit Price ${a+1}`,required:"",error:n(r).errors[`services.${a}.unit_price`]},{default:b(()=>[e("div",Ue,[t[19]||(t[19]=e("span",{class:"absolute left-3 top-2 text-gray-500"},"$",-1)),m(w,{modelValue:s.unit_price,"onUpdate:modelValue":c=>s.unit_price=c,placeholder:"0.00",inputmode:"decimal",class:"pl-8",onInput:c=>D(c,a)},null,8,["modelValue","onUpdate:modelValue","onInput"])])]),_:2},1032,["label","error"]),s.quantity&&s.unit_price?(l(),d("div",ze,[e("div",Ne,[e("div",Ie,[e("span",Fe,"Subtotal Service "+i(a+1)+":",1),e("span",Te," $"+i(E(s)),1)]),e("div",Ae,i(s.quantity)+" × $"+i(s.unit_price),1)])])):p("",!0)],64)),f(s.service_id)?(l(),d("div",De)):p("",!0),_(s.service_id)?(l(),d("div",Ee,[e("div",He,[t[23]||(t[23]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Service Details:",-1)),e("div",Pe,[e("div",null,[t[20]||(t[20]=e("strong",null,"Service:",-1)),h(" "+i(_(s.service_id).service),1)]),e("div",null,[t[21]||(t[21]=e("strong",null,"Type:",-1)),e("span",{class:U([_(s.service_id).type==="service"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800","inline-block px-2 py-1 rounded text-xs font-medium ml-1"])},i(_(s.service_id).type==="service"?"Service":"Terms & Conditions"),3)]),_(s.service_id).specifications&&_(s.service_id).specifications.length>0?(l(),d("div",Le,[t[22]||(t[22]=e("strong",null,"Available Specifications:",-1)),e("ul",Oe,[(l(!0),d(x,null,k(_(s.service_id).specifications,c=>(l(),d("li",{key:c.id,class:"text-xs"},i(c.description),1))),128))])])):p("",!0)])])])):p("",!0)])]))),128))]),n(r).services.length>0&&N.value?(l(),d("div",Qe,[e("div",Ge,[e("div",Je,[e("div",null,[t[24]||(t[24]=e("span",{class:"text-lg font-semibold text-gray-800"},"Contract Total:",-1)),e("div",Ke,i(I())+" paid service(s)",1)]),e("span",Re," $"+i(P()),1)])])])):p("",!0)])]),e("div",We,[e("button",{type:"button",onClick:O,class:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",{type:"submit",disabled:n(r).processing||n(r).services.length===0,class:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"},[n(r).processing?(l(),d("span",Ye,[t[25]||(t[25]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),h(" "+i(g.value?"Updating...":"Creating..."),1)])):(l(),d("span",Ze,i(g.value?"Update Contract":"Create Contract"),1))],8,Xe)])],32)])])]),_:1}))}};export{lt as default};
